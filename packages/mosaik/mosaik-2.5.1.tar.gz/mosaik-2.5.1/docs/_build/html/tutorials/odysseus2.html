

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using Odysseus to process, visualize and store simulation data &mdash; mosaik 2.5.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="mosaik 2.5.1 documentation" href="../index.html"/>
        <link rel="up" title="Tutorials" href="index.html"/>
        <link rel="next" title="Integrating a Model in Java" href="tutorial_api-java.html"/>
        <link rel="prev" title="Connecting mosaik and Odysseus" href="odysseus.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>
</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> mosaik
          

          
          </a>

          
            
            
              <div class="version">
                2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystem/index.html">Modular Design</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="examplesim.html">Integrating a simulation model into the mosaik ecosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="demo1.html">Creating and running simple simulation scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="examplectrl.html">Adding a control mechanism to a scenario</a></li>
<li class="toctree-l2"><a class="reference internal" href="demo2.html">Integrating a control mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="cyclicdf.html">Cyclic data-flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="odysseus.html">Connecting mosaik and Odysseus</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Using Odysseus to process, visualize and store simulation data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#processing">Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualisation">Visualisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#storing">Storing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_api-java.html">Integrating a Model in Java</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mosaik-api/index.html">The mosaik API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenario-definition.html">Scenario definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simmanager.html">The simulator manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduler.html">Scheduling and simulation execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">Developer&#8217;s Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About mosaik</a></li>
<li class="toctree-l1"><a class="reference internal" href="../privacy.html">Privacy Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legals.html">Legals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datenschutz.html">Datenschutz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../impressum.html">Impressum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">mosaik</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="index.html">Tutorials</a> &raquo;</li>
      
    <li>Using Odysseus to process, visualize and store simulation data</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="../_sources/tutorials/odysseus2.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-odysseus-to-process-visualize-and-store-simulation-data">
<h1>Using Odysseus to process, visualize and store simulation data<a class="headerlink" href="#using-odysseus-to-process-visualize-and-store-simulation-data" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will give some examples on how you can use Odysseus to process,
visualize and store the data from mosaik. More information about connecting
mosaik and Odysseus can be found in the <a class="reference internal" href="odysseus.html"><span class="doc">first part</span></a> of the
tutorial and more about Odysseus in general can be found in its
<a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS">documentation</a>.
If you have no experience with Odysseus you should first visit the tutorials in
its documentation. <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/Simple+Query+Processing">Simple query processing</a>
and <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/Selection%2C+Projection+and+Map">selection, projection and map</a>
should explain the basics.</p>
<div class="section" id="processing">
<span id="id1"></span><h2>Processing<a class="headerlink" href="#processing" title="Permalink to this headline">¶</a></h2>
<p>Mosaik sends data in JSON format and so the key-value-object has to be used as datatype for receiving in Odysseus.
But most operators in Odysseus are based on relational tuples with a fixed schema,
so it can be useful to transform arriving key-value objects to relational tuples.
For this the <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/KeyValueToTuple+operator">keyvaluetotuple</a> operator can be used.
It creates relational tuples with the given attributes and omitts all data, which is not included in the schema:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tuples</span> <span class="o">=</span> <span class="n">KEYVALUETOTUPLE</span><span class="p">({</span>
        <span class="n">SCHEMA</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span><span class="s1">&#39;odysseus_0.Vm.PyPower-0.0-tr_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;Double&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;odysseus_0.Vm.PyPower-0.0-node_b1&#39;</span><span class="p">,</span> <span class="s1">&#39;Double&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;odysseus_0.Vm.PyPower-0.0-node_b2&#39;</span><span class="p">,</span> <span class="s1">&#39;Double&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;odysseus_0.Vm.PyPower-0.0-node_b3&#39;</span><span class="p">,</span> <span class="s1">&#39;Double&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;odysseus_0.Vm.PyPower-0.0-node_b4&#39;</span><span class="p">,</span> <span class="s1">&#39;Double&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;STARTTIMESTAMP&#39;</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="n">TYPE</span> <span class="o">=</span> <span class="s1">&#39;mosaik&#39;</span><span class="p">},</span>
        <span class="n">mosaikCon</span><span class="p">)</span>
</pre></div>
</div>
<p>For better handling we can rename the attributes with the <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/Rename+operator">rename</a> operator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">renamedTuples</span> <span class="o">=</span> <span class="n">RENAME</span><span class="p">({</span><span class="n">aliases</span> <span class="o">=</span>
                <span class="p">[</span><span class="s1">&#39;tr_sec_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;node1_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;node2_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;node3_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;node4_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
        <span class="p">},</span> <span class="n">tuples</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also add computations to the data with a <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/Map+operator">map</a> operator.
The expressions parameter contains first the computation and second the new name for every attribute.
In this example the deviation of voltage to the nominal voltage of 230 V is calculated (more information about the offered functions can be found <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/MEP%3A+Functions+and+Operators">here</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">voltageDeviation</span> <span class="o">=</span> <span class="n">MAP</span><span class="p">({</span><span class="n">EXPRESSIONS</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span><span class="s1">&#39;abs(230 - tr_sec_Vm)&#39;</span><span class="p">,</span> <span class="s1">&#39;dev_tr_sec_Vm&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;abs(230 - Node1_Vm)&#39;</span><span class="p">,</span> <span class="s1">&#39;dev_Node1_Vm&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;abs(230 - Node2_Vm)&#39;</span><span class="p">,</span> <span class="s1">&#39;dev_Node2_Vm&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;abs(230 - Node3_Vm)&#39;</span><span class="p">,</span> <span class="s1">&#39;dev_Node3_Vm&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;abs(230 - Node4_Vm)&#39;</span><span class="p">,</span> <span class="s1">&#39;dev_Node4_Vm&#39;</span><span class="p">]</span>
        <span class="p">]},</span> <span class="n">renamedTuples</span><span class="p">)</span>
</pre></div>
</div>
<p>By using the <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/Aggregate+%28and+Group%29+operator">aggregate</a>
operator we are able to calculate e.g. the average values.
We have to add an <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/TimeWindow">timewindow</a>
operator first to have the right timestamps for aggregating.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">windowedTuples</span> <span class="o">=</span> <span class="n">TIMEWINDOW</span><span class="p">({</span><span class="n">SIZE</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;MINUTES&#39;</span><span class="p">]},</span> <span class="n">voltageDeviation</span><span class="p">)</span>
<span class="n">aggregatedTuples</span> <span class="o">=</span> <span class="n">AGGREGATE</span><span class="p">({</span>
        <span class="n">AGGREGATIONS</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span><span class="s1">&#39;AVG&#39;</span><span class="p">,</span> <span class="s1">&#39;dev_tr_sec_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;AVG_dev_tr_sec_P&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;AVG&#39;</span><span class="p">,</span> <span class="s1">&#39;dev_Node1_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;AVG_dev_Node1_P&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;AVG&#39;</span><span class="p">,</span> <span class="s1">&#39;dev_Node2_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;AVG_dev_Node2_P&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;AVG&#39;</span><span class="p">,</span> <span class="s1">&#39;dev_Node3_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;AVG_dev_Node3_P&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;AVG&#39;</span><span class="p">,</span> <span class="s1">&#39;dev_Node4_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;AVG_dev_Node4_P&#39;</span><span class="p">]</span>
                <span class="p">]},</span>
        <span class="n">windowedTuples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="visualisation">
<span id="id2"></span><h2>Visualisation<a class="headerlink" href="#visualisation" title="Permalink to this headline">¶</a></h2>
<p>To visualize data in Odysseus dashboards can be used, which can contain different graphs.
For the data stream shown in the section above an exemplary dashboard could look like the following picture:</p>
<a class="reference internal image-reference" href="../_images/odysseus_visualisation.svg"><div align="center" class="align-center"><img alt="visualisation of simulation data in Odysseus" src="../_images/odysseus_visualisation.svg" width="600" /></div>
</a>
<p>More information about dashboards in Odysseus can be found in the <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/Dashboard+Feature">documentation</a>.</p>
</div>
<div class="section" id="storing">
<span id="id4"></span><h2>Storing<a class="headerlink" href="#storing" title="Permalink to this headline">¶</a></h2>
<p>If we want to save the results of our Odysseus query, we can use the <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/Sender+operator">sender</a> operator to export it, e.g. to a csv file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="o">=</span> <span class="n">SENDER</span><span class="p">({</span>
        <span class="n">SINK</span><span class="o">=</span><span class="s1">&#39;writeCSV&#39;</span><span class="p">,</span>
        <span class="n">transport</span><span class="o">=</span><span class="s1">&#39;File&#39;</span><span class="p">,</span>
        <span class="n">wrapper</span><span class="o">=</span><span class="s1">&#39;GenericPush&#39;</span><span class="p">,</span>
        <span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;CSV&#39;</span><span class="p">,</span>
        <span class="n">dataHandler</span><span class="o">=</span><span class="s1">&#39;Tuple&#39;</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                <span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span><span class="s1">&#39;$</span><span class="si">{WORKSPACEPROJECT}</span><span class="s1">\output2.csv&#39;</span><span class="p">]</span>
        <span class="p">]},</span> <span class="n">aggregatedTuples</span><span class="p">)</span>
</pre></div>
</div>
<p>Odysseus also offers adapters to store the processed data to different databases (e.g. mysql, postgres and oracle).
More details can be found <a class="reference external" href="http://wiki.odysseus.informatik.uni-oldenburg.de/display/ODYSSEUS/Database+Feature">here</a>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial_api-java.html" class="btn btn-neutral float-right" title="Integrating a Model in Java" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="odysseus.html" class="btn btn-neutral" title="Connecting mosaik and Odysseus" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2018 OFFIS.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.5.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   
  <!-- Piwik Image Tracker-->
  <img src="https://mosaik.offis.de/analytics/piwik.php?idsite=4&rec=1" style="border:0" alt="" />
  <!-- End Piwik -->
</body>
</html>