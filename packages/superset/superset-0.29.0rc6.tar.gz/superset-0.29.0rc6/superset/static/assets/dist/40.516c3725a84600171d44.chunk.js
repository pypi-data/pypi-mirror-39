(window.webpackJsonp=window.webpackJsonp||[]).push([[40,44],{1327:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MILES_PER_KM=e.EARTH_CIRCUMFERENCE_KM=e.defaultViewport=void 0,e.unitToRadius=function(t,e){if("square_m"===t)return Math.sqrt(e/Math.PI);if("radius_m"===t)return e;if("radius_km"===t)return 1e3*e;if("radius_miles"===t)return e*r;if("square_km"===t)return 1e3*Math.sqrt(e/Math.PI);if("square_miles"===t)return Math.sqrt(e/Math.PI)*r;return null},e.kmToPixels=function(t,e,n){var r=e*(Math.PI/180),a=i*Math.cos(r)/Math.pow(2,n+9);return(0,o.round)(t/a,2)};var o=n(89),r=(e.defaultViewport={longitude:6.85236157047845,latitude:31.222656842808707,zoom:1,bearing:0,pitch:0},1609.34);var i=e.EARTH_CIRCUMFERENCE_KM=40075.16;e.MILES_PER_KM=1.60934},1567:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_POINT_RADIUS=e.DEFAULT_MAX_ZOOM=void 0;var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=h(n(1)),a=h(n(0)),s=h(n(2547)),u=h(n(1657)),l=h(n(2535)),p=h(n(2630));function h(t){return t&&t.__esModule?t:{default:t}}n(2631);var d=function(){return function(){}}(),c=(e.DEFAULT_MAX_ZOOM=16,e.DEFAULT_POINT_RADIUS=60),f={width:a.default.number,height:a.default.number,aggregatorName:a.default.string,clusterer:a.default.object,globalOpacity:a.default.number,mapStyle:a.default.string,mapboxApiKey:a.default.string,onViewportChange:a.default.func,pointRadius:a.default.number,pointRadiusUnit:a.default.string,renderWhileDragging:a.default.bool,rgb:a.default.array,bounds:a.default.array},g={globalOpacity:1,onViewportChange:d,pointRadius:c,pointRadiusUnit:"Pixels"},m=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),o=n.props,r=o.width,i=o.height,a=o.bounds,s=new l.default({width:r,height:i}).fitBounds(a),u=s.latitude,p=s.longitude,h=s.zoom;return n.state={viewport:{longitude:p,latitude:u,zoom:h}},n.onViewportChange=n.onViewportChange.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["default"].Component),r(e,[{key:"onViewportChange",value:function(){return function(t){this.setState({viewport:t}),this.props.onViewportChange(t)}}()},{key:"render",value:function(){return function(){var t=this.props,e=t.width,n=t.height,r=t.aggregatorName,a=t.globalOpacity,l=t.mapStyle,h=t.mapboxApiKey,d=t.pointRadius,c=t.pointRadiusUnit,f=t.renderWhileDragging,g=t.rgb,m=t.hasCustomMetric,v=t.bounds,b=this.state.viewport,w=void 0!==b.isDragging&&b.isDragging,y=[v[0][0],v[0][1],v[1][0],v[1][1]],_=this.props.clusterer.getClusters(y,Math.round(b.zoom));return i.default.createElement(s.default,o({},b,{mapStyle:l,width:e,height:n,mapboxApiAccessToken:h,onViewportChange:this.onViewportChange}),i.default.createElement(p.default,o({},b,{isDragging:w,width:e,height:n,locations:u.default.fromJS(_),dotRadius:d,pointRadiusUnit:c,rgb:g,globalOpacity:a,compositeOperation:"screen",renderWhileDragging:f,aggregation:m?r:null,lngLatAccessor:function(t){var e=t.get("geometry").get("coordinates");return[e.get(0),e.get(1)]}})))}}()}]),e}();m.propTypes=f,m.defaultProps=g,e.default=m},1583:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.width,n=t.height,o=t.formData,r=t.onError,s=t.payload,u=t.setControlValue,l=s.data,p=l.bounds,h=l.geoJSON,d=l.hasCustomMetric,c=l.mapboxApiKey,f=o.clusteringRadius,g=o.globalOpacity,m=o.mapboxColor,v=o.mapboxStyle,b=o.pandasAggfunc,w=o.pointRadius,y=o.pointRadiusUnit,_=o.renderWhileDragging,M=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/.exec(m);if(null===M)return r("Color field must be of form 'rgb(%d, %d, %d)'"),{};var x={radius:f,maxZoom:a.DEFAULT_MAX_ZOOM};d&&(x.initial=function(){return{sum:0,squaredSum:0,min:1/0,max:-1/0}},x.map=function(t){return{sum:t.metric,squaredSum:Math.pow(t.metric,2),min:t.metric,max:t.metric}},x.reduce=function(t,e){t.sum+=e.sum,t.squaredSum+=e.squaredSum,t.min=Math.min(t.min,e.min),t.max=Math.max(t.max,e.max)});var O=(0,i.default)(x);return O.load(h.features),{width:e,height:n,aggregatorName:b,bounds:p,clusterer:O,globalOpacity:g,hasCustomMetric:d,mapboxApiKey:c,mapStyle:v,onViewportChange:function(t){var e=t.latitude,n=t.longitude,o=t.zoom;u("viewport_longitude",n),u("viewport_latitude",e),u("viewport_zoom",o)},pointRadius:"Auto"===w?a.DEFAULT_POINT_RADIUS:w,pointRadiusUnit:y,renderWhileDragging:_,rgb:M}};var o,r=n(2900),i=(o=r)&&o.__esModule?o:{default:o},a=n(1567)},2630:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=h(n(1657)),i=h(n(1)),a=h(n(0)),s=h(n(2535)),u=n(89),l=n(1327),p=n(481);function h(t){return t&&t.__esModule?t:{default:t}}var d={aggregation:a.default.string,locations:a.default.instanceOf(r.default.List).isRequired,lngLatAccessor:a.default.func,renderWhileDragging:a.default.bool,globalOpacity:a.default.number,dotRadius:a.default.number,dotFill:a.default.string,compositeOperation:a.default.string},c={lngLatAccessor:function(){return function(t){return[t.get(0),t.get(1)]}}(),renderWhileDragging:!0,dotRadius:4,dotFill:"#1FBAD6",globalOpacity:1,compositeOperation:"source-over"},f={viewport:a.default.object,isDragging:a.default.bool},g=function(){return function(t,e){var n=t.get("point_count");if(!e)return n;if("sum"===e||"min"===e||"max"===e)return t.get(e);var o=t.get("sum"),r=o/n;if("mean"===e)return Math.round(100*r)/100;var i=t.get("squaredSum")/n-Math.pow(o/n,2);return"var"===e?Math.round(100*i)/100:"stdev"===e?Math.round(100*Math.sqrt(i))/100:n}}(),m=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.setCanvasRef=n.setCanvasRef.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["default"].Component),o(e,[{key:"componentDidMount",value:function(){return function(){this.redraw()}}()},{key:"componentDidUpdate",value:function(){return function(){this.redraw()}}()},{key:"setCanvasRef",value:function(){return function(t){this.canvas=t}}()},{key:"drawText",value:function(){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.fontHeight,r=void 0===o?0:o,i=n.label,a=void 0===i?"":i,s=n.radius,u=void 0===s?0:s,l=n.rgb,h=void 0===l?[0,0,0]:l,d=n.shadow,c=void 0!==d&&d,f=1.8*u,g=(0,p.rgbLuminance)(h[1],h[2],h[3]);t.globalCompositeOperation="source-over",t.fillStyle=g<=110?"white":"black",t.font=r+"px sans-serif",t.textAlign="center",t.textBaseline="middle",c&&(t.shadowBlur=15,t.shadowColor=g<=110?"black":"");var m=t.measureText(a).width;if(m>f){var v=r/m;t.font=v*f+"px sans-serif"}t.fillText(a,e[0],e[1]),t.globalCompositeOperation=this.props.compositeOperation,t.shadowBlur=0,t.shadowColor=""}}()},{key:"redraw",value:function(){return function(){var t=this.props,e=window.devicePixelRatio||1,n=this.canvas.getContext("2d"),o=t.dotRadius,r=new s.default(t),i=t.rgb,a=[];t.locations.forEach(function(e,n){e.get("properties").get("cluster")&&(a[n]=g(e.get("properties"),t.aggregation))},this);var p=Math.max.apply(Math,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(Object.values(a)));n.save(),n.scale(e,e),n.clearRect(0,0,t.width,t.height),n.globalCompositeOperation=t.compositeOperation,!t.renderWhileDragging&&t.isDragging||!t.locations||t.locations.forEach(function(e,s){var h=r.project(t.lngLatAccessor(e)),d=[(0,u.round)(h[0],1),(0,u.round)(h[1],1)];if(d[0]+o>=0&&d[0]-o<t.width&&d[1]+o>=0&&d[1]-o<t.height)if(n.beginPath(),e.get("properties").get("cluster")){var c=a[s],f=(0,u.round)(Math.pow(c/p,.5)*o,1),g=(0,u.round)(.5*f,1),m=n.createRadialGradient(d[0],d[1],f,d[0],d[1],0);m.addColorStop(1,"rgba("+i[1]+", "+i[2]+", "+i[3]+", 0.8)"),m.addColorStop(0,"rgba("+i[1]+", "+i[2]+", "+i[3]+", 0)"),n.arc(d[0],d[1],f,0,2*Math.PI),n.fillStyle=m,n.fill(),Number.isFinite(parseFloat(c))&&(c>=1e4?c=Math.round(c/1e3)+"k":c>=1e3&&(c=Math.round(c/100)/10+"k"),this.drawText(n,d,{fontHeight:g,label:c,radius:f,rgb:i,shadow:!0}))}else{var v=o/6,b=e.get("properties").get("radius"),w=e.get("properties").get("metric"),y=null===b?v:b,_=void 0;if(null!==b){var M=t.lngLatAccessor(e)[1];"Kilometers"===t.pointRadiusUnit?(_=(0,u.round)(y,2)+"km",y=(0,l.kmToPixels)(y,M,t.zoom)):"Miles"===t.pointRadiusUnit&&(_=(0,u.round)(y,2)+"mi",y=(0,l.kmToPixels)(y*l.MILES_PER_KM,M,t.zoom))}null!==w&&(_=Number.isFinite(parseFloat(w))?(0,u.round)(w,2):w),y||(y=v),n.arc(d[0],d[1],(0,u.round)(y,1),0,2*Math.PI),n.fillStyle="rgb("+i[1]+", "+i[2]+", "+i[3]+")",n.fill(),void 0!==_&&this.drawText(n,d,{fontHeight:(0,u.round)(y,1),label:_,radius:y,rgb:i,shadow:!1})}},this),n.restore()}}()},{key:"render",value:function(){return function(){var t=0,e=0;this.context.viewport&&(t=this.context.viewport.width,e=this.context.viewport.height);var n=this.props.globalOpacity,o=window.devicePixelRatio||1;return i.default.createElement("canvas",{ref:this.setCanvasRef,width:t*o,height:e*o,style:{width:t+"px",height:e+"px",position:"absolute",pointerEvents:"none",opacity:n,left:0,top:0}})}}()}]),e}();m.propTypes=d,m.defaultProps=c,m.contextTypes=f,e.default=m},2631:function(t,e,n){},2900:function(t,e,n){"use strict";function o(t,e,n,i,a,s){if(!(a-i<=n)){var u=Math.floor((i+a)/2);!function t(e,n,o,i,a,s){for(;a>i;){if(a-i>600){var u=a-i+1,l=o-i+1,p=Math.log(u),h=.5*Math.exp(2*p/3),d=.5*Math.sqrt(p*h*(u-h)/u)*(l-u/2<0?-1:1),c=Math.max(i,Math.floor(o-l*h/u+d)),f=Math.min(a,Math.floor(o+(u-l)*h/u+d));t(e,n,o,c,f,s)}var g=n[2*o+s],m=i,v=a;for(r(e,n,i,o),n[2*a+s]>g&&r(e,n,i,a);m<v;){for(r(e,n,m,v),m++,v--;n[2*m+s]<g;)m++;for(;n[2*v+s]>g;)v--}n[2*i+s]===g?r(e,n,i,v):r(e,n,++v,a),v<=o&&(i=v+1),o<=v&&(a=v-1)}}(t,e,u,i,a,s%2),o(t,e,n,i,u-1,s+1),o(t,e,n,u+1,a,s+1)}}function r(t,e,n,o){i(t,n,o),i(e,2*n,2*o),i(e,2*n+1,2*o+1)}function i(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function a(t,e,n,o){var r=t-n,i=e-o;return r*r+i*i}function s(t,e,n,o,r){return new u(t,e,n,o,r)}function u(t,e,n,r,i){e=e||l,n=n||p,i=i||Array,this.nodeSize=r||64,this.points=t,this.ids=new i(t.length),this.coords=new i(2*t.length);for(var a=0;a<t.length;a++)this.ids[a]=a,this.coords[2*a]=e(t[a]),this.coords[2*a+1]=n(t[a]);o(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function l(t){return t[0]}function p(t){return t[1]}function h(t){return new d(t)}function d(t){this.options=b(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function c(t,e,n,o,r){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:o,properties:r}}function f(t){return{type:"Feature",id:t.id,properties:g(t),geometry:{type:"Point",coordinates:[(o=t.x,360*(o-.5)),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n,o}function g(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return b(b({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function m(t){return t/360+.5}function v(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function b(t,e){for(var n in e)t[n]=e[n];return t}function w(t){return t.x}function y(t){return t.y}n.r(e),u.prototype={range:function(t,e,n,o){return function(t,e,n,o,r,i,a){for(var s,u,l=[0,t.length-1,0],p=[];l.length;){var h=l.pop(),d=l.pop(),c=l.pop();if(d-c<=a)for(var f=c;f<=d;f++)s=e[2*f],u=e[2*f+1],s>=n&&s<=r&&u>=o&&u<=i&&p.push(t[f]);else{var g=Math.floor((c+d)/2);s=e[2*g],u=e[2*g+1],s>=n&&s<=r&&u>=o&&u<=i&&p.push(t[g]);var m=(h+1)%2;(0===h?n<=s:o<=u)&&(l.push(c),l.push(g-1),l.push(m)),(0===h?r>=s:i>=u)&&(l.push(g+1),l.push(d),l.push(m))}}return p}(this.ids,this.coords,t,e,n,o,this.nodeSize)},within:function(t,e,n){return function(t,e,n,o,r,i){for(var s=[0,t.length-1,0],u=[],l=r*r;s.length;){var p=s.pop(),h=s.pop(),d=s.pop();if(h-d<=i)for(var c=d;c<=h;c++)a(e[2*c],e[2*c+1],n,o)<=l&&u.push(t[c]);else{var f=Math.floor((d+h)/2),g=e[2*f],m=e[2*f+1];a(g,m,n,o)<=l&&u.push(t[f]);var v=(p+1)%2;(0===p?n-r<=g:o-r<=m)&&(s.push(d),s.push(f-1),s.push(v)),(0===p?n+r>=g:o+r>=m)&&(s.push(f+1),s.push(h),s.push(v))}}return u}(this.ids,this.coords,t,e,n,this.nodeSize)}},n.d(e,"default",function(){return h}),d.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var n="prepare "+t.length+" points";e&&console.time(n),this.points=t;for(var o,r,i,a=[],u=0;u<t.length;u++)t[u].geometry&&a.push((o=t[u],r=u,void 0,{x:m((i=o.geometry.coordinates)[0]),y:v(i[1]),zoom:1/0,index:r,parentId:-1}));this.trees[this.options.maxZoom+1]=s(a,w,y,this.options.nodeSize,Float32Array),e&&console.timeEnd(n);for(var l=this.options.maxZoom;l>=this.options.minZoom;l--){var p=+Date.now();a=this._cluster(a,l),this.trees[l]=s(a,w,y,this.options.nodeSize,Float32Array),e&&console.log("z%d: %d clusters in %dms",l,a.length,+Date.now()-p)}return e&&console.timeEnd("total time"),this},getClusters:function(t,e){var n=((t[0]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[1])),r=180===t[2]?180:((t[2]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,r=180;else if(n>r){var a=this.getClusters([n,o,180,i],e),s=this.getClusters([-180,o,r,i],e);return a.concat(s)}for(var u=this.trees[this._limitZoom(e)],l=u.range(m(n),v(i),m(r),v(o)),p=[],h=0;h<l.length;h++){var d=u.points[l[h]];p.push(d.numPoints?f(d):this.points[d.index])}return p},getChildren:function(t){var e=t>>5,n=t%32,o="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(o);var i=r.points[e];if(!i)throw new Error(o);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=r.within(i.x,i.y,a),u=[],l=0;l<s.length;l++){var p=r.points[s[l]];p.parentId===t&&u.push(p.numPoints?f(p):this.points[p.index])}if(0===u.length)throw new Error(o);return u},getLeaves:function(t,e,n){e=e||10,n=n||0;var o=[];return this._appendLeaves(o,t,e,n,0),o},getTile:function(t,e,n){var o=this.trees[this._limitZoom(t)],r=Math.pow(2,t),i=this.options.extent,a=this.options.radius/i,s=(n-a)/r,u=(n+1+a)/r,l={features:[]};return this._addTileFeatures(o.range((e-a)/r,s,(e+1+a)/r,u),o.points,e,n,r,l),0===e&&this._addTileFeatures(o.range(1-a/r,s,1,u),o.points,r,n,r,l),e===r-1&&this._addTileFeatures(o.range(0,s,a/r,u),o.points,-1,n,r,l),l.features.length?l:null},getClusterExpansionZoom:function(t){for(var e=t%32-1;e<this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},_appendLeaves:function(t,e,n,o,r){for(var i=this.getChildren(e),a=0;a<i.length;a++){var s=i[a].properties;if(s&&s.cluster?r+s.point_count<=o?r+=s.point_count:r=this._appendLeaves(t,s.cluster_id,n,o,r):r<o?r++:t.push(i[a]),t.length===n)break}return r},_addTileFeatures:function(t,e,n,o,r,i){for(var a=0;a<t.length;a++){var s=e[t[a]],u={type:1,geometry:[[Math.round(this.options.extent*(s.x*r-n)),Math.round(this.options.extent*(s.y*r-o))]],tags:s.numPoints?g(s):this.points[s.index].properties},l=s.numPoints?s.id:this.points[s.index].id;void 0!==l&&(u.id=l),i.features.push(u)}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var n=[],o=this.options.radius/(this.options.extent*Math.pow(2,e)),r=0;r<t.length;r++){var i=t[r];if(!(i.zoom<=e)){i.zoom=e;var a=this.trees[e+1],s=a.within(i.x,i.y,o),u=i.numPoints||1,l=i.x*u,p=i.y*u,h=null;this.options.reduce&&(h=this.options.initial(),this._accumulate(h,i));for(var d=(r<<5)+(e+1),f=0;f<s.length;f++){var g=a.points[s[f]];if(!(g.zoom<=e)){g.zoom=e;var m=g.numPoints||1;l+=g.x*m,p+=g.y*m,u+=m,g.parentId=d,this.options.reduce&&this._accumulate(h,g)}}1===u?n.push(i):(i.parentId=d,n.push(c(l/u,p/u,d,u,h)))}}return n},_accumulate:function(t,e){var n=e.numPoints?e.properties:this.options.map(this.points[e.index].properties);this.options.reduce(t,n)}}}}]);