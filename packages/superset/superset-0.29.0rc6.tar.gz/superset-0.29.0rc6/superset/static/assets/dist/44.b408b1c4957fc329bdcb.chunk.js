(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{1327:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MILES_PER_KM=e.EARTH_CIRCUMFERENCE_KM=e.defaultViewport=void 0,e.unitToRadius=function(t,e){if("square_m"===t)return Math.sqrt(e/Math.PI);if("radius_m"===t)return e;if("radius_km"===t)return 1e3*e;if("radius_miles"===t)return e*o;if("square_km"===t)return 1e3*Math.sqrt(e/Math.PI);if("square_miles"===t)return Math.sqrt(e/Math.PI)*o;return null},e.kmToPixels=function(t,e,r){var o=e*(Math.PI/180),a=i*Math.cos(o)/Math.pow(2,r+9);return(0,n.round)(t/a,2)};var n=r(89),o=(e.defaultViewport={longitude:6.85236157047845,latitude:31.222656842808707,zoom:1,bearing:0,pitch:0},1609.34);var i=e.EARTH_CIRCUMFERENCE_KM=40075.16;e.MILES_PER_KM=1.60934},1567:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_POINT_RADIUS=e.DEFAULT_MAX_ZOOM=void 0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=f(r(1)),a=f(r(0)),u=f(r(2547)),l=f(r(1657)),s=f(r(2535)),c=f(r(2630));function f(t){return t&&t.__esModule?t:{default:t}}r(2631);var d=function(){return function(){}}(),p=(e.DEFAULT_MAX_ZOOM=16,e.DEFAULT_POINT_RADIUS=60),g={width:a.default.number,height:a.default.number,aggregatorName:a.default.string,clusterer:a.default.object,globalOpacity:a.default.number,mapStyle:a.default.string,mapboxApiKey:a.default.string,onViewportChange:a.default.func,pointRadius:a.default.number,pointRadiusUnit:a.default.string,renderWhileDragging:a.default.bool,rgb:a.default.array,bounds:a.default.array},h={globalOpacity:1,onViewportChange:d,pointRadius:p,pointRadiusUnit:"Pixels"},b=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),n=r.props,o=n.width,i=n.height,a=n.bounds,u=new s.default({width:o,height:i}).fitBounds(a),l=u.latitude,c=u.longitude,f=u.zoom;return r.state={viewport:{longitude:c,latitude:l,zoom:f}},r.onViewportChange=r.onViewportChange.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["default"].Component),o(e,[{key:"onViewportChange",value:function(){return function(t){this.setState({viewport:t}),this.props.onViewportChange(t)}}()},{key:"render",value:function(){return function(){var t=this.props,e=t.width,r=t.height,o=t.aggregatorName,a=t.globalOpacity,s=t.mapStyle,f=t.mapboxApiKey,d=t.pointRadius,p=t.pointRadiusUnit,g=t.renderWhileDragging,h=t.rgb,b=t.hasCustomMetric,v=t.bounds,w=this.state.viewport,m=void 0!==w.isDragging&&w.isDragging,y=[v[0][0],v[0][1],v[1][0],v[1][1]],_=this.props.clusterer.getClusters(y,Math.round(w.zoom));return i.default.createElement(u.default,n({},w,{mapStyle:s,width:e,height:r,mapboxApiAccessToken:f,onViewportChange:this.onViewportChange}),i.default.createElement(c.default,n({},w,{isDragging:m,width:e,height:r,locations:l.default.fromJS(_),dotRadius:d,pointRadiusUnit:p,rgb:h,globalOpacity:a,compositeOperation:"screen",renderWhileDragging:g,aggregation:b?o:null,lngLatAccessor:function(t){var e=t.get("geometry").get("coordinates");return[e.get(0),e.get(1)]}})))}}()}]),e}();b.propTypes=g,b.defaultProps=h,e.default=b},2630:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=f(r(1657)),i=f(r(1)),a=f(r(0)),u=f(r(2535)),l=r(89),s=r(1327),c=r(481);function f(t){return t&&t.__esModule?t:{default:t}}var d={aggregation:a.default.string,locations:a.default.instanceOf(o.default.List).isRequired,lngLatAccessor:a.default.func,renderWhileDragging:a.default.bool,globalOpacity:a.default.number,dotRadius:a.default.number,dotFill:a.default.string,compositeOperation:a.default.string},p={lngLatAccessor:function(){return function(t){return[t.get(0),t.get(1)]}}(),renderWhileDragging:!0,dotRadius:4,dotFill:"#1FBAD6",globalOpacity:1,compositeOperation:"source-over"},g={viewport:a.default.object,isDragging:a.default.bool},h=function(){return function(t,e){var r=t.get("point_count");if(!e)return r;if("sum"===e||"min"===e||"max"===e)return t.get(e);var n=t.get("sum"),o=n/r;if("mean"===e)return Math.round(100*o)/100;var i=t.get("squaredSum")/r-Math.pow(n/r,2);return"var"===e?Math.round(100*i)/100:"stdev"===e?Math.round(100*Math.sqrt(i))/100:r}}(),b=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.setCanvasRef=r.setCanvasRef.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["default"].Component),n(e,[{key:"componentDidMount",value:function(){return function(){this.redraw()}}()},{key:"componentDidUpdate",value:function(){return function(){this.redraw()}}()},{key:"setCanvasRef",value:function(){return function(t){this.canvas=t}}()},{key:"drawText",value:function(){return function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.fontHeight,o=void 0===n?0:n,i=r.label,a=void 0===i?"":i,u=r.radius,l=void 0===u?0:u,s=r.rgb,f=void 0===s?[0,0,0]:s,d=r.shadow,p=void 0!==d&&d,g=1.8*l,h=(0,c.rgbLuminance)(f[1],f[2],f[3]);t.globalCompositeOperation="source-over",t.fillStyle=h<=110?"white":"black",t.font=o+"px sans-serif",t.textAlign="center",t.textBaseline="middle",p&&(t.shadowBlur=15,t.shadowColor=h<=110?"black":"");var b=t.measureText(a).width;if(b>g){var v=o/b;t.font=v*g+"px sans-serif"}t.fillText(a,e[0],e[1]),t.globalCompositeOperation=this.props.compositeOperation,t.shadowBlur=0,t.shadowColor=""}}()},{key:"redraw",value:function(){return function(){var t=this.props,e=window.devicePixelRatio||1,r=this.canvas.getContext("2d"),n=t.dotRadius,o=new u.default(t),i=t.rgb,a=[];t.locations.forEach(function(e,r){e.get("properties").get("cluster")&&(a[r]=h(e.get("properties"),t.aggregation))},this);var c=Math.max.apply(Math,function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(Object.values(a)));r.save(),r.scale(e,e),r.clearRect(0,0,t.width,t.height),r.globalCompositeOperation=t.compositeOperation,!t.renderWhileDragging&&t.isDragging||!t.locations||t.locations.forEach(function(e,u){var f=o.project(t.lngLatAccessor(e)),d=[(0,l.round)(f[0],1),(0,l.round)(f[1],1)];if(d[0]+n>=0&&d[0]-n<t.width&&d[1]+n>=0&&d[1]-n<t.height)if(r.beginPath(),e.get("properties").get("cluster")){var p=a[u],g=(0,l.round)(Math.pow(p/c,.5)*n,1),h=(0,l.round)(.5*g,1),b=r.createRadialGradient(d[0],d[1],g,d[0],d[1],0);b.addColorStop(1,"rgba("+i[1]+", "+i[2]+", "+i[3]+", 0.8)"),b.addColorStop(0,"rgba("+i[1]+", "+i[2]+", "+i[3]+", 0)"),r.arc(d[0],d[1],g,0,2*Math.PI),r.fillStyle=b,r.fill(),Number.isFinite(parseFloat(p))&&(p>=1e4?p=Math.round(p/1e3)+"k":p>=1e3&&(p=Math.round(p/100)/10+"k"),this.drawText(r,d,{fontHeight:h,label:p,radius:g,rgb:i,shadow:!0}))}else{var v=n/6,w=e.get("properties").get("radius"),m=e.get("properties").get("metric"),y=null===w?v:w,_=void 0;if(null!==w){var O=t.lngLatAccessor(e)[1];"Kilometers"===t.pointRadiusUnit?(_=(0,l.round)(y,2)+"km",y=(0,s.kmToPixels)(y,O,t.zoom)):"Miles"===t.pointRadiusUnit&&(_=(0,l.round)(y,2)+"mi",y=(0,s.kmToPixels)(y*s.MILES_PER_KM,O,t.zoom))}null!==m&&(_=Number.isFinite(parseFloat(m))?(0,l.round)(m,2):m),y||(y=v),r.arc(d[0],d[1],(0,l.round)(y,1),0,2*Math.PI),r.fillStyle="rgb("+i[1]+", "+i[2]+", "+i[3]+")",r.fill(),void 0!==_&&this.drawText(r,d,{fontHeight:(0,l.round)(y,1),label:_,radius:y,rgb:i,shadow:!1})}},this),r.restore()}}()},{key:"render",value:function(){return function(){var t=0,e=0;this.context.viewport&&(t=this.context.viewport.width,e=this.context.viewport.height);var r=this.props.globalOpacity,n=window.devicePixelRatio||1;return i.default.createElement("canvas",{ref:this.setCanvasRef,width:t*n,height:e*n,style:{width:t+"px",height:e+"px",position:"absolute",pointerEvents:"none",opacity:r,left:0,top:0}})}}()}]),e}();b.propTypes=d,b.defaultProps=p,b.contextTypes=g,e.default=b},2631:function(t,e,r){}}]);