# Define as many interface sections as you like;
# typically up to 4 interfaces are supported per Raspberry Pi
# (each one of them uses two MCP23017 chips, and there can be max 8 of them
# on a single I2C bus).
#
# Each interface will be available on a separate URL:
# http://[host:port]/interfaces/[lowercase_section_name].
#
# If a parameter is not set, it will be taken from default settings for all interfaces,
# and if that is not available, the driver program will fall back on hardcoded default.
#
# General settings:
# -----------------
#
# name                : name this interface will be visible under
#
#
# Hardware I/O settings:
# ---------------------
#
# output_driver       :  which output driver to use (smbus or wiringpi)
# sensor_gpio         : GPIO pin for machine cycle sensor
# motor_start_gpio    : GPIO pin for motor start relay
# motor_stop_gpio     : GPIO pin for motor stop relay
# water_gpio          : GPIO pin for water cutoff solenoid valve
# air_gpio            : GPIO pin for air cutoff solenoid valve
# error_led_gpio      : GPIO pin for error (stop pump) LED
# working_led_gpio    : GPIO pin for working LED (interface in use)
# mode_detect_gpio     : GPIO pin for casting/punching mode detection
# emergency_stop_gpio : GPIO pin for emergency stop button
# i2c_bus             : I2C bus number
# mcp0_address        : 1st MCP23017 address
# mcp1_address        : 2nd MCP23017 address
# valve1, valve2,     : signals assignments to valves
# valve3, valve4      : this decides which valve controller gets what signals
#                       valve1: mcp0 port A, valve2: mcp0 port B,
#                       valve3: mcp1 port A, valve4: mcp1 port B
#
# Timing settings:
# ---------------
#
# debounce_milliseconds  :  sensor and button de-bounce time
# startup_timeout        :  how long to wait for rotation during machine check
# sensor_timeout         :  as above, when casting
# pump_stop_timeout      :  as above, when stopping the pump
# punching_on_time       :  how long the valves are open during punching
# punching_off_time      :  how long the valves are shut during punching
#
# ready_led_gpio     :  "ready" LED GPIO #
# shutdown_gpio      :  shutdown button GPIO #
# shutdown_command   :  system command for shutdown
# reboot_gpio        :  reboot button GPIO #
# reboot_command     :  system command for reboot
# listen_address     :  address (DNS or IP) and optionally port to listen on


[DEFAULT]
name = Monotype Composition Caster
sensor_gpio = 17
emergency_stop_gpio = 22
motor_start_gpio = 5
motor_stop_gpio = 6
water_gpio = 13
air_gpio = 19
error_led_gpio = 26
working_led_gpio = 25
mode_detect_gpio=27
i2c_bus = 1
mcp0_address = 0x20
mcp1_address = 0x21
valve1 = N,M,L,K,J,I,H,G
valve2 = F,S,E,D,0075,C,B,A
valve3 = 1,2,3,4,5,6,7,8
valve4 = 9,10,11,12,13,14,0005,O15

listen_address = 0.0.0.0:23017
output_driver = smbus

ready_led_gpio = 18
shutdown_gpio = 24
shutdown_command = sudo systemctl poweroff
reboot_gpio = 23
reboot_command = sudo systemctl reboot

debounce_milliseconds = 25
startup_timeout = 30
sensor_timeout = 5
pump_stop_timeout = 120
punching_on_time = 0.2
punching_off_time = 0.3

