

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2. EQcorrscan installation &mdash; EQcorrscan 0.3.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/EQcorrscan_logo.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="EQcorrscan 0.3.0 documentation" href="index.html"/>
        <link rel="next" title="3. What’s new" href="updates.html"/>
        <link rel="prev" title="1. Introduction to the EQcorrscan package" href="intro.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> EQcorrscan
          

          
            
            <img src="_static/EQcorrscan_logo.jpg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction to the EQcorrscan package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. EQcorrscan installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation-without-conda">2.1. Installation without conda</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#non-python-dependencies-ubuntu">2.1.1. Non-Python dependencies–Ubuntu:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#non-python-dependencies-osx">2.1.2. Non-Python dependencies–OSX:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#non-python-dependencies-windows">2.1.3. Non-Python dependencies–Windows:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eqcorrscan-install-via-pip">2.1.4. EQcorrscan install via pip:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-from-source">2.1.5. Installation from source</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-intel-s-mkl">2.1.6. Using Intel’s MKL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#notes">2.2. Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="updates.html">3. What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">EQcorrscan tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">4. Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">5. Utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EQcorrscan</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>2. EQcorrscan installation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/installation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="eqcorrscan-installation">
<h1>2. EQcorrscan installation<a class="headerlink" href="#eqcorrscan-installation" title="Permalink to this headline">¶</a></h1>
<p>EQcorrscan is a Python package with C extensions. The C extensions in EQcorrscan
have their own dependencies on compiled libraries. We heavily recommend installing
EQcorrscan using conda because this will:</p>
<blockquote>
<div><ul class="simple">
<li>make your life easier;</li>
<li>separate your EQcorrscan install from your system Python, meaning you can
experiment to your hearts-content without breaking your operating system (yay);</li>
<li>ensure that compiled modules are compiled using the correct C-compiler against
the correct libraries</li>
</ul>
</div></blockquote>
<p>If you do not have either a miniconda or anaconda installation you can follow
the <a href="https://conda.io/docs/user-guide/install/index.html#installing-conda-on-a-system-that-has-other-python-installations-or-packages" target="_blank">conda-install</a> instructions.</p>
<p>If you do not already have a conda environment we recommend creating one
with the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda create -n eqcorrscan colorama numpy scipy matplotlib obspy bottleneck pyproj
<span class="nb">source</span> activate eqcorrscan
</pre></div>
</div>
<p>To then install EQcorrscan you can simply run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install -c conda-forge eqcorrscan
</pre></div>
</div>
<div class="section" id="installation-without-conda">
<h2>2.1. Installation without conda<a class="headerlink" href="#installation-without-conda" title="Permalink to this headline">¶</a></h2>
<p>Installing EQcorrscan without conda involves two steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Installing fftw3 libraries;</li>
<li>Installing python dependancies and EQcorrscan.</li>
</ol>
</div></blockquote>
<p>How you undertake the first step depends on your operating system and system
package manager.</p>
<div class="section" id="non-python-dependencies-ubuntu">
<h3>2.1.1. Non-Python dependencies–Ubuntu:<a class="headerlink" href="#non-python-dependencies-ubuntu" title="Permalink to this headline">¶</a></h3>
<p>Prior to installing the python routines you will need to install the fftw
library.  On linux use apt (or your default package manager - note you may need
sudo access):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt-get install libfftw3-dev
</pre></div>
</div>
<p>Note that you will need to ensure you have the single-precision libraries of
fftw3 (files named fftw3f…). On CentOS you can install the <cite>fftw-libs</cite> package.</p>
</div>
<div class="section" id="non-python-dependencies-osx">
<h3>2.1.2. Non-Python dependencies–OSX:<a class="headerlink" href="#non-python-dependencies-osx" title="Permalink to this headline">¶</a></h3>
<p>For MacOS/OS-X systems we have tested using homebrew and macports (fink options
are available, but we haven’t tested them).</p>
<p><strong>Homebrew</strong></p>
<p>You will need a recent version of gcc (the homebrew gcc-4.9 port has issues with openMP).
We have tested the following and found it to work (note that you may need to prepend
sudo depending on your configuration):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>brew install gcc6
brew install fftw
</pre></div>
</div>
<p>Then run the following to install EQcorrscan (note the need to select CC=gcc, clang,
the default compiler, does not support modern openMP pragmas):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CC</span><span class="o">=</span>gcc pip install eqcorrscan
</pre></div>
</div>
<p><strong>MacPorts</strong></p>
<p>The following has been tested and found to work (note that you may need to prepend
sudo depending on your configuration):</p>
<ol class="arabic simple">
<li>Install an up-to-date gcc (gcc is needed for openmp compatibility) - any gcc should work (&gt;4), here we use gcc6 for example:</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>port install gcc6
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Install python from macports (tested for python35, but its up to you)</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>port install python35<span class="sb">`</span>
<span class="c1"># optional: select python35 as default python for terminal:</span>
port <span class="k">select</span> --set python python35
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Install numpy and pip from macports:</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>port install py35-numpy py35-pip
<span class="c1"># optional, select pip35 as default pip</span>
port <span class="k">select</span> --set pip pip35
</pre></div>
</div>
<ol class="arabic" start="4">
<li><p class="first">Install fftw3 from source, use <cite>–enable-threads and –enable-float</cite> (fftw-3 and fftw-3-single from macports also available, but not tested)</p>
<blockquote>
<div><blockquote>
<div><ol class="loweralpha simple">
<li><a href="http://www.fftw.org/fftw-3.3.7.tar.gz" target="_blank">Download</a> - link to fftw 3.3.7, most recent as of 10/01/2018</li>
<li>unzip/untar</li>
</ol>
</div></blockquote>
<ol class="loweralpha simple" start="3">
<li>Run the following from within the expanded directory:</li>
</ol>
</div></blockquote>
</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./configure --enable-threads --enable-float <span class="o">&amp;&amp;</span> make
make install
./configure --enable-threads <span class="o">&amp;&amp;</span> make <span class="c1"># Need both double and float precision files</span>
make install
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li>Run: (if you didn’t run the <cite>port select –set pip pip35</cite> command you will need to replace <cite>pip</cite> with <cite>pip35</cite>)</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CC</span><span class="o">=</span>gcc pip install eqcorrscan
</pre></div>
</div>
</div>
<div class="section" id="non-python-dependencies-windows">
<h3>2.1.3. Non-Python dependencies–Windows:<a class="headerlink" href="#non-python-dependencies-windows" title="Permalink to this headline">¶</a></h3>
<p>For Windows systems you should follow the instructions on the <a href="http://www.fftw.org/install/windows.html" target="_blank">fftw-windows install</a>
page and use the pre-compiled dynamic libraries. These should be installed
somewhere on your system path, or the install location added to your path.
The correlation routines use openMP for parallel workflows, however, some aspects
of this run into issues with version of MSVC &lt; 10.0 (due to old C standards being
used), as such, by default, the correlation routines are compiled as serial
workflows on windows.  If you have a need for this threading in windows please
get in touch with the developers.</p>
</div>
<div class="section" id="eqcorrscan-install-via-pip">
<h3>2.1.4. EQcorrscan install via pip:<a class="headerlink" href="#eqcorrscan-install-via-pip" title="Permalink to this headline">¶</a></h3>
<p>Once you have installed fftw the EQcorrscan install should be as simple as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install eqcorrscan
</pre></div>
</div>
</div>
<div class="section" id="installation-from-source">
<h3>2.1.5. Installation from source<a class="headerlink" href="#installation-from-source" title="Permalink to this headline">¶</a></h3>
<p>pip pulls the package from the <a href="https://pypi.org/project/EQcorrscan/" target="_blank">PyPi</a> package repository and runs the <cite>setup.py</cite> file.
If instead you wish to install from source, download the package (either by cloning
the git repository, or by downloading the source code) from <a href="https://github.com/eqcorrscan/EQcorrscan" target="_blank">github</a>,
change directory to the <cite>EQcorrscan</cite> directory and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python setup.py install
</pre></div>
</div>
<p>If this fails because the default compiler is <cite>clang</cite> you can run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CC</span><span class="o">=</span>gcc python setup.py install
</pre></div>
</div>
<p>Note though that this will compile EQcorrscan using a different compiler than
used to build your Python, which may have unwanted effects, if you do this you
MUST test you install using the instructions here: <a class="reference internal" href="intro.html#runningtests"><span class="std std-ref">Running tests</span></a>.</p>
</div>
<div class="section" id="using-intel-s-mkl">
<h3>2.1.6. Using Intel’s MKL<a class="headerlink" href="#using-intel-s-mkl" title="Permalink to this headline">¶</a></h3>
<p>For version 0.3.0 EQcorrscan supports compilation against the Intel Math Kernel
Libraries (MKL). This has shown <a href="https://github.com/eqcorrscan/EQcorrscan/pull/168" target="_blank">speed ups</a> compared to the standard FFTW library.
To enable this you must install MKL before compiling EQcorrscan.  MKL is available from
most package managers (including conda). Once you have MKL installed you can
follow the <a class="reference internal" href="#installation-from-source">Installation from source</a> section.  Check that near the top of the
install that the MKL libraries are found.</p>
</div>
</div>
<div class="section" id="notes">
<h2>2.2. Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<p>You may have issues with these installs if you don’t have numpy installed: but if
you don’t have numpy installed then you have bigger issues…</p>
<p>If you plan to run the <em>bright_lights</em> or generating a synthetic grid of
templates you will need to have grid csv files, which the authors have
previously used NonLinLoc to generate.  This is not provided here and should
be sourced from <a href="http://alomax.free.fr/nlloc/" target="_blank">NonLinLoc</a>. This will provide
the Grid2Time routine which is required to set-up a lag-time grid for your
velocity model.  You should read the NonLinLoc documentation for more
information regarding how this process works and the input files you are
required to give.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="updates.html" class="btn btn-neutral float-right" title="3. What’s new" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro.html" class="btn btn-neutral" title="1. Introduction to the EQcorrscan package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, 2016: EQcorrscan developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>