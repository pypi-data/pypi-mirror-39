

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.6.3.1.5. match_filter.Tribe &mdash; EQcorrscan 0.3.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/EQcorrscan_logo.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="EQcorrscan 0.3.0 documentation" href="../index.html"/>
        <link rel="up" title="4.6.3. match_filter" href="core.match_filter.html"/>
        <link rel="next" title="4.6.3.2.1. eqcorrscan.core.match_filter.extract_from_stream" href="autogen/eqcorrscan.core.match_filter.extract_from_stream.html"/>
        <link rel="prev" title="4.6.3.1.4. match_filter.Template" href="core.match_filter.Template.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> EQcorrscan
          

          
            
            <img src="../_static/EQcorrscan_logo.jpg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">1. Introduction to the EQcorrscan package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">2. EQcorrscan installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../updates.html">3. What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">EQcorrscan tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../core.html">4. Core</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../core.html#brightness">4.1. Brightness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#template-generation">4.2. Template generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#matched-filter">4.3. Matched-Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#lag-calc">4.4. Lag-Calc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html#subspace">4.5. Subspace</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../core.html#api-docs">4.6. API-docs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="core.bright_lights.html">4.6.1. bright_lights</a></li>
<li class="toctree-l3"><a class="reference internal" href="core.lag_calc.html">4.6.2. lag_calc</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="core.match_filter.html">4.6.3. match_filter</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="core.match_filter.html#classes">4.6.3.1. Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="core.match_filter.html#functions">4.6.3.2. Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="core.match_filter.html#private-functions">4.6.3.3. Private Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="core.subspace.html">4.6.4. subspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="core.template_gen.html">4.6.5. template_gen</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">5. Utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EQcorrscan</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../core.html">4. Core</a> &raquo;</li>
        
          <li><a href="core.match_filter.html">4.6.3. match_filter</a> &raquo;</li>
        
      <li>4.6.3.1.5. match_filter.Tribe</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/submodules/core.match_filter.Tribe.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="match-filter-tribe">
<h1>4.6.3.1.5. match_filter.Tribe<a class="headerlink" href="#match-filter-tribe" title="Permalink to this headline">¶</a></h1>
<p>See notes and warnings on correlations here: <a class="reference external" href="utils.correlate.html#notes-on-accuracy">correlation_warnings</a></p>
<dl class="class">
<dt id="eqcorrscan.core.match_filter.Tribe">
<em class="property">class </em><code class="descclassname">eqcorrscan.core.match_filter.</code><code class="descname">Tribe</code><span class="sig-paren">(</span><em>templates=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Holder for multiple templates.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#eqcorrscan.core.match_filter.Tribe.client_detect" title="eqcorrscan.core.match_filter.Tribe.client_detect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">client_detect</span></code></a>(client,&nbsp;starttime,&nbsp;endtime,&nbsp;…)</td>
<td>Detect using a Tribe of templates within a continuous stream.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#eqcorrscan.core.match_filter.Tribe.cluster" title="eqcorrscan.core.match_filter.Tribe.cluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cluster</span></code></a>(method,&nbsp;**kwargs)</td>
<td>Cluster the tribe.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#eqcorrscan.core.match_filter.Tribe.construct" title="eqcorrscan.core.match_filter.Tribe.construct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">construct</span></code></a>(method,&nbsp;lowcut,&nbsp;highcut,&nbsp;…)</td>
<td>Generate a Tribe of Templates.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#eqcorrscan.core.match_filter.Tribe.copy" title="eqcorrscan.core.match_filter.Tribe.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</td>
<td>Copy the Tribe.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#eqcorrscan.core.match_filter.Tribe.detect" title="eqcorrscan.core.match_filter.Tribe.detect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">detect</span></code></a>(stream,&nbsp;threshold,&nbsp;threshold_type,&nbsp;…)</td>
<td>Detect using a Tribe of templates within a continuous stream.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#eqcorrscan.core.match_filter.Tribe.read" title="eqcorrscan.core.match_filter.Tribe.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(filename)</td>
<td>Read a tribe of templates from a tar formatted file.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#eqcorrscan.core.match_filter.Tribe.remove" title="eqcorrscan.core.match_filter.Tribe.remove"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove</span></code></a>(template)</td>
<td>Remove a template from the tribe.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#eqcorrscan.core.match_filter.Tribe.sort" title="eqcorrscan.core.match_filter.Tribe.sort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort</span></code></a>()</td>
<td>Sort the tribe, sorts by template name.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#eqcorrscan.core.match_filter.Tribe.write" title="eqcorrscan.core.match_filter.Tribe.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>(filename[,&nbsp;compress])</td>
<td>Write the tribe to a file using tar archive formatting.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="eqcorrscan.core.match_filter.Tribe.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>templates=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="eqcorrscan.core.match_filter.Tribe.client_detect">
<code class="descname">client_detect</code><span class="sig-paren">(</span><em>client</em>, <em>starttime</em>, <em>endtime</em>, <em>threshold</em>, <em>threshold_type</em>, <em>trig_int</em>, <em>plotvar</em>, <em>daylong=False</em>, <em>parallel_process=True</em>, <em>xcorr_func=None</em>, <em>concurrency=None</em>, <em>cores=None</em>, <em>ignore_length=False</em>, <em>group_size=None</em>, <em>debug=0</em>, <em>return_stream=False</em>, <em>full_peaks=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe.client_detect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe.client_detect" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect using a Tribe of templates within a continuous stream.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>client</strong> (<cite>obspy.clients.*.Client</cite>) – Any obspy client with a dataselect service.</li>
<li><strong>starttime</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.UTCDateTime</span></code>) – Start-time for detections.</li>
<li><strong>endtime</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.UTCDateTime</span></code>) – End-time for detections</li>
<li><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Threshold level, if using <cite>threshold_type=’MAD’</cite> then this will be
the multiple of the median absolute deviation.</li>
<li><strong>threshold_type</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The type of threshold to be used, can be MAD, absolute or
av_chan_corr.  See Note on thresholding below.</li>
<li><strong>trig_int</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Minimum gap between detections in seconds. If multiple detections
occur within trig_int of one-another, the one with the highest
cross-correlation sum will be selected.</li>
<li><strong>plotvar</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Turn plotting on or off, see warning about plotting below</li>
<li><strong>daylong</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Set to True to use the
<a class="reference internal" href="autogen/eqcorrscan.utils.pre_processing.dayproc.html#eqcorrscan.utils.pre_processing.dayproc" title="eqcorrscan.utils.pre_processing.dayproc"><code class="xref py py-func docutils literal notranslate"><span class="pre">eqcorrscan.utils.pre_processing.dayproc()</span></code></a> routine, which
preforms additional checks and is more efficient for day-long data
over other methods.</li>
<li><strong>parallel_process</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – </li>
<li><strong>xcorr_func</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>callable</em>) – A str of a registered xcorr function or a callable for implementing
a custom xcorr function. For more information see:
<a class="reference internal" href="autogen/eqcorrscan.utils.correlate.register_array_xcorr.html#eqcorrscan.utils.correlate.register_array_xcorr" title="eqcorrscan.utils.correlate.register_array_xcorr"><code class="xref py py-func docutils literal notranslate"><span class="pre">eqcorrscan.utils.correlate.register_array_xcorr()</span></code></a></li>
<li><strong>concurrency</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The type of concurrency to apply to the xcorr function. Options are
‘multithread’, ‘multiprocess’, ‘concurrent’. For more details see
<a class="reference internal" href="autogen/eqcorrscan.utils.correlate.get_stream_xcorr.html#eqcorrscan.utils.correlate.get_stream_xcorr" title="eqcorrscan.utils.correlate.get_stream_xcorr"><code class="xref py py-func docutils literal notranslate"><span class="pre">eqcorrscan.utils.correlate.get_stream_xcorr()</span></code></a></li>
<li><strong>cores</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of workers for processing and detection.</li>
<li><strong>ignore_length</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If using daylong=True, then dayproc will try check that the data
are there for at least 80% of the day, if you don’t want this check
(which will raise an error if too much data are missing) then set
ignore_length=True.  This is not recommended!</li>
<li><strong>group_size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Maximum number of templates to run at once, use to reduce memory
consumption, if unset will use all templates.</li>
<li><strong>full_peaks</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – See <cite>eqcorrscan.utils.findpeaks.find_peaks2_short</cite></li>
<li><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Debug level from 0-5 where five is more output, for debug levels
4 and 5, detections will not be computed in parallel.</li>
<li><strong>return_stream</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to also output the stream downloaded, useful if you plan
to use the stream for something else, e.g. lag_calc.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="core.match_filter.Party.html#eqcorrscan.core.match_filter.Party" title="eqcorrscan.core.match_filter.Party"><code class="xref py py-class docutils literal notranslate"><span class="pre">eqcorrscan.core.match_filter.Party</span></code></a> of Families of
detections.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Picks included in the output Party.get_catalog() will not be
corrected for pre-picks in the template.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ensures that data overlap between loops, which will lead to no
missed detections at data start-stop points (see note for
<a class="reference internal" href="#eqcorrscan.core.match_filter.Tribe.detect" title="eqcorrscan.core.match_filter.Tribe.detect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eqcorrscan.core.match_filter.Tribe.detect()</span></code></a> method).
This will result in end-time not being strictly
honoured, so detections may occur after the end-time set.  This is
because data must be run in the correct process-length.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Plotting within the match-filter routine uses the Agg backend
with interactive plotting turned off.  This is because the function
is designed to work in bulk.  If you wish to turn interactive
plotting on you must import matplotlib in your script first,
when you then import match_filter you will get the warning that
this call to matplotlib has no effect, which will mean that
match_filter has not changed the plotting behaviour.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Thresholding:</strong></p>
<p><strong>MAD</strong> threshold is calculated as the:</p>
<div class="math notranslate">
\[threshold {\times} (median(abs(cccsum)))\]</div>
<p>where <span class="math notranslate">\(cccsum\)</span> is the cross-correlation sum for a given
template.</p>
<p><strong>absolute</strong> threshold is a true absolute threshold based on the
cccsum value.</p>
<p><strong>av_chan_corr</strong> is based on the mean values of single-channel
cross-correlations assuming all data are present as required for
the template, e.g:</p>
<div class="math notranslate">
\[av\_chan\_corr\_thresh=threshold \times (cccsum /
len(template))\]</div>
<p class="last">where <span class="math notranslate">\(template\)</span> is a single template from the input and the
length is the number of channels within this template.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="eqcorrscan.core.match_filter.Tribe.cluster">
<code class="descname">cluster</code><span class="sig-paren">(</span><em>method</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe.cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Cluster the tribe.</p>
<p>Cluster templates within a tribe: returns multiple tribes each of
which could be stacked.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Method of stacking, see <a class="reference internal" href="utils.clustering.html#module-eqcorrscan.utils.clustering" title="eqcorrscan.utils.clustering"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eqcorrscan.utils.clustering</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of tribes.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
</dd></dl>

<dl class="method">
<dt id="eqcorrscan.core.match_filter.Tribe.construct">
<code class="descname">construct</code><span class="sig-paren">(</span><em>method</em>, <em>lowcut</em>, <em>highcut</em>, <em>samp_rate</em>, <em>filt_order</em>, <em>prepick</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a Tribe of Templates.</p>
<p>See <a class="reference internal" href="core.template_gen.html#module-eqcorrscan.core.template_gen" title="eqcorrscan.core.template_gen"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eqcorrscan.core.template_gen</span></code></a> for available methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> – Method of Tribe generation.</li>
<li><strong>kwargs</strong> – Arguments for the given method.</li>
<li><strong>lowcut</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Low cut (Hz), if set to None will not apply a lowcut</li>
<li><strong>highcut</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – High cut (Hz), if set to None will not apply a highcut.</li>
<li><strong>samp_rate</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – New sampling rate in Hz.</li>
<li><strong>filt_order</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Filter level (number of corners).</li>
<li><strong>prepick</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Pre-pick time in seconds</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Methods: <cite>from_contbase</cite>, <cite>from_sfile</cite> and <cite>from_sac</cite> are not
supported by Tribe.construct and must use Template.construct.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Method <cite>multi_template_gen</cite> is not supported because the
processing parameters for the stream are not known. Use
<cite>from_meta_file</cite> instead.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Templates will be named according to their start-time.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="eqcorrscan.core.match_filter.Tribe.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy the Tribe.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tribe_a</span> <span class="o">=</span> <span class="n">Tribe</span><span class="p">(</span><span class="n">templates</span><span class="o">=</span><span class="p">[</span><span class="n">Template</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tribe_b</span> <span class="o">=</span> <span class="n">tribe_a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tribe_a</span> <span class="o">==</span> <span class="n">tribe_b</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="eqcorrscan.core.match_filter.Tribe.detect">
<code class="descname">detect</code><span class="sig-paren">(</span><em>stream</em>, <em>threshold</em>, <em>threshold_type</em>, <em>trig_int</em>, <em>plotvar</em>, <em>daylong=False</em>, <em>parallel_process=True</em>, <em>xcorr_func=None</em>, <em>concurrency=None</em>, <em>cores=None</em>, <em>ignore_length=False</em>, <em>group_size=None</em>, <em>overlap='calculate'</em>, <em>debug=0</em>, <em>full_peaks=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe.detect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe.detect" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect using a Tribe of templates within a continuous stream.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stream</strong> (<cite>obspy.core.stream.Stream</cite>) – Continuous data to detect within using the Template.</li>
<li><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Threshold level, if using <cite>threshold_type=’MAD’</cite> then this will be
the multiple of the median absolute deviation.</li>
<li><strong>threshold_type</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The type of threshold to be used, can be MAD, absolute or
av_chan_corr.  See Note on thresholding below.</li>
<li><strong>trig_int</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Minimum gap between detections in seconds. If multiple detections
occur within trig_int of one-another, the one with the highest
cross-correlation sum will be selected.</li>
<li><strong>plotvar</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Turn plotting on or off, see warning about plotting below</li>
<li><strong>daylong</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Set to True to use the
<a class="reference internal" href="autogen/eqcorrscan.utils.pre_processing.dayproc.html#eqcorrscan.utils.pre_processing.dayproc" title="eqcorrscan.utils.pre_processing.dayproc"><code class="xref py py-func docutils literal notranslate"><span class="pre">eqcorrscan.utils.pre_processing.dayproc()</span></code></a> routine, which
preforms additional checks and is more efficient for day-long data
over other methods.</li>
<li><strong>parallel_process</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – </li>
<li><strong>xcorr_func</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>callable</em>) – A str of a registered xcorr function or a callable for implementing
a custom xcorr function. For more information see:
<a class="reference internal" href="autogen/eqcorrscan.utils.correlate.register_array_xcorr.html#eqcorrscan.utils.correlate.register_array_xcorr" title="eqcorrscan.utils.correlate.register_array_xcorr"><code class="xref py py-func docutils literal notranslate"><span class="pre">eqcorrscan.utils.correlate.register_array_xcorr()</span></code></a></li>
<li><strong>concurrency</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The type of concurrency to apply to the xcorr function. Options are
‘multithread’, ‘multiprocess’, ‘concurrent’. For more details see
<a class="reference internal" href="autogen/eqcorrscan.utils.correlate.get_stream_xcorr.html#eqcorrscan.utils.correlate.get_stream_xcorr" title="eqcorrscan.utils.correlate.get_stream_xcorr"><code class="xref py py-func docutils literal notranslate"><span class="pre">eqcorrscan.utils.correlate.get_stream_xcorr()</span></code></a></li>
<li><strong>cores</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of workers for procesisng and detection.</li>
<li><strong>ignore_length</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If using daylong=True, then dayproc will try check that the data
are there for at least 80% of the day, if you don’t want this check
(which will raise an error if too much data are missing) then set
ignore_length=True.  This is not recommended!</li>
<li><strong>group_size</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Maximum number of templates to run at once, use to reduce memory
consumption, if unset will use all templates.</li>
<li><strong>overlap</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Either None, “calculate” or a float of number of seconds to
overlap detection streams by.  This is to counter the effects of
the delay-and-stack in calculating cross-correlation sums. Setting
overlap = “calculate” will work out the appropriate overlap based
on the maximum lags within templates.</li>
<li><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Debug level from 0-5 where five is more output, for debug levels
4 and 5, detections will not be computed in parallel.</li>
<li><strong>full_peaks</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – See <cite>eqcorrscan.utils.findpeak.find_peaks2_short</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="core.match_filter.Party.html#eqcorrscan.core.match_filter.Party" title="eqcorrscan.core.match_filter.Party"><code class="xref py py-class docutils literal notranslate"><span class="pre">eqcorrscan.core.match_filter.Party</span></code></a> of Families of
detections.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>stream</cite> must not be pre-processed.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Picks included in the output Party.get_catalog() will not be
corrected for pre-picks in the template.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Plotting within the match-filter routine uses the Agg backend
with interactive plotting turned off.  This is because the function
is designed to work in bulk.  If you wish to turn interactive
plotting on you must import matplotlib in your script first,
when you then import match_filter you will get the warning that
this call to matplotlib has no effect, which will mean that
match_filter has not changed the plotting behaviour.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Data overlap:</strong></p>
<p>Internally this routine shifts and trims the data according to the
offsets in the template (e.g. if trace 2 starts 2 seconds after
trace 1 in the template then the continuous data will be shifted
by 2 seconds to align peak correlations prior to summing).
Because of this, detections at the start and end of continuous
data streams <strong>may be missed</strong>.  The maximum time-period that
might be missing detections is the maximum offset in the template.</p>
<p class="last">To work around this, if you are conducting matched-filter
detections through long-duration continuous data, we suggest
using some overlap (a few seconds, on the order of the maximum
offset in the templates) in the continuous data.  You will then
need to post-process the detections (which should be done anyway
to remove duplicates).  See below note for how <cite>overlap</cite> argument
affects data internally if <cite>stream</cite> is longer than the processing
length.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <cite>stream</cite> is long then processing length, this routine will
ensure that data overlap between loops, which will lead to no
missed detections at data start-stop points (see above note).
This will result in end-time not being strictly
honoured, so detections may occur after the end-time set.  This is
because data must be run in the correct process-length.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Thresholding:</strong></p>
<p><strong>MAD</strong> threshold is calculated as the:</p>
<div class="math notranslate">
\[threshold {\times} (median(abs(cccsum)))\]</div>
<p>where <span class="math notranslate">\(cccsum\)</span> is the cross-correlation sum for a given
template.</p>
<p><strong>absolute</strong> threshold is a true absolute threshold based on the
cccsum value.</p>
<p><strong>av_chan_corr</strong> is based on the mean values of single-channel
cross-correlations assuming all data are present as required for
the template, e.g:</p>
<div class="math notranslate">
\[av\_chan\_corr\_thresh=threshold \times (cccsum /
len(template))\]</div>
<p class="last">where <span class="math notranslate">\(template\)</span> is a single template from the input and the
length is the number of channels within this template.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="eqcorrscan.core.match_filter.Tribe.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a tribe of templates from a tar formatted file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – File to read templates from.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tribe</span> <span class="o">=</span> <span class="n">Tribe</span><span class="p">(</span><span class="n">templates</span><span class="o">=</span><span class="p">[</span><span class="n">Template</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">st</span><span class="o">=</span><span class="n">read</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tribe</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;test_tribe&#39;</span><span class="p">)</span>
<span class="go">Tribe of 1 templates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tribe_back</span> <span class="o">=</span> <span class="n">Tribe</span><span class="p">()</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;test_tribe.tgz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tribe_back</span> <span class="o">==</span> <span class="n">tribe</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="eqcorrscan.core.match_filter.Tribe.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>template</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a template from the tribe.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>template</strong> (<a class="reference internal" href="core.match_filter.Template.html#eqcorrscan.core.match_filter.Template" title="eqcorrscan.core.match_filter.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">eqcorrscan.core.match_filter.Template</span></code></a>) – Template to remove from tribe</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tribe</span> <span class="o">=</span> <span class="n">Tribe</span><span class="p">(</span><span class="n">templates</span><span class="o">=</span><span class="p">[</span><span class="n">Template</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="n">Template</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">Template</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tribe</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tribe</span><span class="o">.</span><span class="n">templates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Tribe of 2 templates</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="eqcorrscan.core.match_filter.Tribe.sort">
<code class="descname">sort</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe.sort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe.sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort the tribe, sorts by template name.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tribe</span> <span class="o">=</span> <span class="n">Tribe</span><span class="p">(</span><span class="n">templates</span><span class="o">=</span><span class="p">[</span><span class="n">Template</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="n">Template</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">Template</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tribe</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="go">Tribe of 3 templates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tribe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
<span class="go">Template a:</span>
<span class="go"> 0 channels;</span>
<span class="go"> lowcut: None Hz;</span>
<span class="go"> highcut: None Hz;</span>
<span class="go"> sampling rate None Hz;</span>
<span class="go"> filter order: None;</span>
<span class="go"> process length: None s</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="eqcorrscan.core.match_filter.Tribe.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>compress=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eqcorrscan/core/match_filter.html#Tribe.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.match_filter.Tribe.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the tribe to a file using tar archive formatting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Filename to write to, if it exists it will be appended to.</li>
<li><strong>compress</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to compress the tar archive or not, if False then will
just be files in a folder.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tribe</span> <span class="o">=</span> <span class="n">Tribe</span><span class="p">(</span><span class="n">templates</span><span class="o">=</span><span class="p">[</span><span class="n">Template</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">st</span><span class="o">=</span><span class="n">read</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tribe</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;test_tribe&#39;</span><span class="p">)</span>
<span class="go">Tribe of 1 templates</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="autogen/eqcorrscan.core.match_filter.extract_from_stream.html" class="btn btn-neutral float-right" title="4.6.3.2.1. eqcorrscan.core.match_filter.extract_from_stream" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="core.match_filter.Template.html" class="btn btn-neutral" title="4.6.3.1.4. match_filter.Template" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, 2016: EQcorrscan developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>