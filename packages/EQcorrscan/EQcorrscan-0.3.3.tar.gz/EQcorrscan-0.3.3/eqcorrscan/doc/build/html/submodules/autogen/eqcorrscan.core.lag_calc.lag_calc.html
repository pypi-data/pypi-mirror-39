

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.6.2.1.1. eqcorrscan.core.lag_calc.lag_calc &mdash; EQcorrscan 0.3.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/EQcorrscan_logo.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="EQcorrscan 0.3.0 documentation" href="../../index.html"/>
        <link rel="up" title="4.6.2. lag_calc" href="../core.lag_calc.html"/>
        <link rel="next" title="4.6.2.2.1. eqcorrscan.core.lag_calc._channel_loop" href="eqcorrscan.core.lag_calc._channel_loop.html"/>
        <link rel="prev" title="4.6.2. lag_calc" href="../core.lag_calc.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> EQcorrscan
          

          
            
            <img src="../../_static/EQcorrscan_logo.jpg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">1. Introduction to the EQcorrscan package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">2. EQcorrscan installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../updates.html">3. What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">EQcorrscan tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../core.html">4. Core</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../core.html#brightness">4.1. Brightness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core.html#template-generation">4.2. Template generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core.html#matched-filter">4.3. Matched-Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core.html#lag-calc">4.4. Lag-Calc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core.html#subspace">4.5. Subspace</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../core.html#api-docs">4.6. API-docs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../core.bright_lights.html">4.6.1. bright_lights</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../core.lag_calc.html">4.6.2. lag_calc</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../core.lag_calc.html#classes-functions">4.6.2.1. Classes &amp; Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../core.lag_calc.html#private-functions">4.6.2.2. Private Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core.match_filter.html">4.6.3. match_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core.subspace.html">4.6.4. subspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core.template_gen.html">4.6.5. template_gen</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../utils.html">5. Utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EQcorrscan</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../core.html">4. Core</a> &raquo;</li>
        
          <li><a href="../core.lag_calc.html">4.6.2. lag_calc</a> &raquo;</li>
        
      <li>4.6.2.1.1. eqcorrscan.core.lag_calc.lag_calc</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/submodules/autogen/eqcorrscan.core.lag_calc.lag_calc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="eqcorrscan-core-lag-calc-lag-calc">
<h1>4.6.2.1.1. eqcorrscan.core.lag_calc.lag_calc<a class="headerlink" href="#eqcorrscan-core-lag-calc-lag-calc" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="eqcorrscan.core.lag_calc.lag_calc">
<code class="descclassname">eqcorrscan.core.lag_calc.</code><code class="descname">lag_calc</code><span class="sig-paren">(</span><em>detections, detect_data, template_names, templates, shift_len=0.2, min_cc=0.4, horizontal_chans=['E', 'N', '1', '2'], vertical_chans=['Z'], cores=1, interpolate=False, plot=False, parallel=True, debug=0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/eqcorrscan/core/lag_calc.html#lag_calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#eqcorrscan.core.lag_calc.lag_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Main lag-calculation function for detections of specific events.</p>
<p>Overseer function to take a list of detection objects, cut the data for
them to lengths of the same length of the template + shift_len on
either side. This will output a <a class="reference external" href="https://docs.obspy.org/packages/autogen/obspy.core.event.Catalog.html#obspy.core.event.Catalog" title="(in ObsPy Documentation (1.1.0) v1.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.event.Catalog</span></code></a> of
picked events. Pick times are based on the lag-times found at the maximum
correlation, providing that correlation is above the min_cc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>detections</strong> (<em>list</em>) – List of <a class="reference internal" href="../core.match_filter.Detection.html#eqcorrscan.core.match_filter.Detection" title="eqcorrscan.core.match_filter.Detection"><code class="xref py py-class docutils literal notranslate"><span class="pre">eqcorrscan.core.match_filter.Detection</span></code></a> objects.</li>
<li><strong>detect_data</strong> (<a class="reference external" href="https://docs.obspy.org/packages/autogen/obspy.core.stream.Stream.html#obspy.core.stream.Stream" title="(in ObsPy Documentation (1.1.0) v1.1)"><em>obspy.core.stream.Stream</em></a>) – All the data needed to cut from - can be a gappy Stream.</li>
<li><strong>template_names</strong> (<em>list</em>) – List of the template names, used to help identify families of events.
Must be in the same order as templates.</li>
<li><strong>templates</strong> (<em>list</em>) – <dl class="docutils">
<dt>List of the templates, templates must be a list of</dt>
<dd><a class="reference external" href="https://docs.obspy.org/packages/autogen/obspy.core.stream.Stream.html#obspy.core.stream.Stream" title="(in ObsPy Documentation (1.1.0) v1.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.stream.Stream</span></code></a> objects.</dd>
</dl>
</li>
<li><strong>shift_len</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Shift length allowed for the pick in seconds, will be plus/minus this
amount - default=0.2</li>
<li><strong>min_cc</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Minimum cross-correlation value to be considered a pick, default=0.4.</li>
<li><strong>horizontal_chans</strong> (<em>list</em>) – List of channel endings for horizontal-channels, on which S-picks will
be made.</li>
<li><strong>vertical_chans</strong> (<em>list</em>) – List of channel endings for vertical-channels, on which P-picks will
be made.</li>
<li><strong>cores</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of cores to use in parallel processing, defaults to one.</li>
<li><strong>interpolate</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Interpolate the correlation function to achieve sub-sample precision.</li>
<li><strong>plot</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – To generate a plot for every detection or not, defaults to False</li>
<li><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Turn parallel processing on or off.</li>
<li><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Debug output level, 0-5 with 5 being the most output.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Catalog of events with picks.  No origin information is included.
These events can then be written out via
<code class="xref py py-func docutils literal notranslate"><span class="pre">obspy.core.event.Catalog.write()</span></code>, or to Nordic Sfiles using
<code class="xref py py-func docutils literal notranslate"><span class="pre">eqcorrscan.utils.sfile_util.eventtosfile()</span></code> and located
externally.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.obspy.org/packages/autogen/obspy.core.event.Catalog.html#obspy.core.event.Catalog" title="(in ObsPy Documentation (1.1.0) v1.1)">obspy.core.event.Catalog</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Picks output in catalog are generated relative to the template
start-time.  For example, if you generated your template with a
pre_pick time of 0.2 seconds, you should expect picks generated by
lag_calc to occur 0.2 seconds before the true phase-pick.  This
is because we do not currently store template meta-data alongside the
templates.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Because of the above note, origin times will be consistently
shifted by the static pre_pick applied to the templates.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This routine requires only one template per channel (e.g. you should
not use templates with a P and S template on a single channel).  If
this does occur an error will be raised.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">S-picks will be made on horizontal channels, and P picks made on
vertical channels - the default is that horizontal channels end in
one of: ‘E’, ‘N’, ‘1’ or ‘2’, and that vertical channels end in ‘Z’.
The options vertical_chans and horizontal_chans can be changed to suit
your dataset.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Individual channel cross-correlations are stored as a
<code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.event.Comment</span></code> for each pick, and the summed
cross-correlation value resulting from these is stored as a
<code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.event.Comment</span></code> in the main
<code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.event.Event</span></code> object.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The order of events is preserved (e.g. detections[n] == output[n]),
providing picks have been made for that event.  If no picks have
been made for an event, it will not be included in the output.
However, as each detection has an ID associated with it, these can
be mapped to the output resource_id for each Event in the output
Catalog. e.g.</p>
<blockquote>
<div>detections[n].id == output[m].resource_id</div></blockquote>
<p class="last">if the output[m] is for the same event as detections[n].</p>
</div>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="eqcorrscan.core.lag_calc._channel_loop.html" class="btn btn-neutral float-right" title="4.6.2.2.1. eqcorrscan.core.lag_calc._channel_loop" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../core.lag_calc.html" class="btn btn-neutral" title="4.6.2. lag_calc" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, 2016: EQcorrscan developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>